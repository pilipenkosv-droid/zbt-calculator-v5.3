<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест расчета скидки</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #0A0F1E; color: white; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #333; border-radius: 8px; }
        .result { color: #FF7A1A; font-weight: bold; }
        .discount { color: #16C784; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Тест расчета скидки в рублях</h1>
    
    <div class="test-case">
        <h3>1 месяц, 1 филиал (без скидки)</h3>
        <div id="test1"></div>
    </div>
    
    <div class="test-case">
        <h3>12 месяцев, 1 филиал (скидка 20%)</h3>
        <div id="test2"></div>
    </div>
    
    <div class="test-case">
        <h3>12 месяцев, 2 филиала (скидка 25%)</h3>
        <div id="test3"></div>
    </div>

    <script>
        function formatRub(value) {
            return new Intl.NumberFormat('ru-RU').format(Math.max(0, Math.round(value))) + ' ₽';
        }
        
        function calculateDiscount(monthly, months, periodDiscount, networkDiscount) {
            const totalDiscount = Math.min(periodDiscount + networkDiscount, 0.25);
            const totalBeforeDiscount = monthly * months;
            const totalAfterDiscount = monthly * months * (1 - totalDiscount);
            const discountRub = totalBeforeDiscount - totalAfterDiscount;
            const discountPercent = Math.round(totalDiscount * 100);
            
            return {
                totalBeforeDiscount,
                totalAfterDiscount,
                discountRub,
                discountPercent
            };
        }
        
        // Тест 1: 1 месяц, 1 филиал
        const test1 = calculateDiscount(50000, 1, 0, 0);
        document.getElementById('test1').innerHTML = 
            `Месячная: <span class="result">${formatRub(50000)}</span> × 1 = <span class="result">${formatRub(test1.totalBeforeDiscount)}</span><br>
            Скидка: <span class="discount">${formatRub(test1.discountRub)}</span> (${test1.discountPercent}%)`;
        
        // Тест 2: 12 месяцев, 1 филиал
        const test2 = calculateDiscount(50000, 12, 0.20, 0);
        document.getElementById('test2').innerHTML = 
            `Месячная: <span class="result">${formatRub(50000)}</span> × 12 = <span class="result">${formatRub(test2.totalBeforeDiscount)}</span><br>
            С учетом скидки: <span class="result">${formatRub(test2.totalAfterDiscount)}</span><br>
            Скидка: <span class="discount">${formatRub(test2.discountRub)}</span> (${test2.discountPercent}%)`;
        
        // Тест 3: 12 месяцев, 2 филиала
        const test3 = calculateDiscount(50000, 12, 0.20, 0.05);
        document.getElementById('test3').innerHTML = 
            `Месячная: <span class="result">${formatRub(50000)}</span> × 12 = <span class="result">${formatRub(test3.totalBeforeDiscount)}</span><br>
            С учетом скидки: <span class="result">${formatRub(test3.totalAfterDiscount)}</span><br>
            Скидка: <span class="discount">${formatRub(test3.discountRub)}</span> (${test3.discountPercent}%)`;
    </script>
</body>
</html>
